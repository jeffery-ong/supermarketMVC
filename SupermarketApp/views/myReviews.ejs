<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title><%= title %></title>
  <link rel="stylesheet" href="/styles.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .review-card img {
      width: 72px;
      height: 72px;
      object-fit: cover;
      border-radius: 0.5rem;
      background: #f8f9fa;
    }
  </style>
</head>
<body>
  <%- include('navbar') %>

  <main class="container py-4">
    <h1 class="mb-4">My Reviews</h1>
    <% const starFilled = '&#9733;'; const starEmpty = '&#9734;'; const renderStars = rating => starFilled.repeat(rating) + starEmpty.repeat(5 - rating); %>
    <% if (!reviews || !reviews.length) { %>
      <div class="alert alert-info">You have not submitted any reviews yet.</div>
    <% } else { %>
      <div class="list-group">
        <% reviews.forEach(r => { %>
          <div class="list-group-item review-card">
            <div class="row g-3 align-items-center">
              <div class="col-auto">
                <img src="<%= r.product_image || '/images/placeholder-product.jpg' %>" alt="<%= r.product_name %>">
              </div>
              <div class="col">
                <div class="d-flex justify-content-between align-items-center">
                  <div class="fw-semibold"><a href="/product/<%= r.product_id %>"><%= r.product_name %></a></div>
                  <div class="text-warning"><%- renderStars(Number(r.rating) || 0) %></div>
                </div>
                <% if (r.comment) { %>
                  <p class="mb-1"><%= r.comment %></p>
                <% } %>
                <small class="text-muted"><%= new Date(r.created_at).toLocaleString() %></small>
              </div>
            </div>
          </div>
        <% }) %>
      </div>
    <% } %>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
